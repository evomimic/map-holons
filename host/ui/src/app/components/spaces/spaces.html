  <!-- Content Spaces Table <h1 class="text-3xl font-bold mb-6">Memetic Activation</h1>-->
  <div class="mb-8">
    <h2 class="text-2xl font-semibold mb-4 text-blue-800">Content Spaces</h2>
    <div class="overflow-x-auto bg-white rounded-lg shadow-md">
      <table class="min-w-full">
        <thead class="bg-blue-200">
          <tr>
            <th class="p-4 text-left">Name</th>
            <th class="p-4 text-left">Description</th>
            <th class="p-4 text-left">Created At</th>
            <th class="p-4 text-left">Enabled</th>
            <th class="p-4 text-left">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let space of contentSpaces()" class="border-b">
            <td class="p-4">
              <a [routerLink]="['/spaces', 'content', space.id]" class="text-blue-600 hover:underline">{{ space.name }}</a>
              <span *ngIf="space.id === space.origin_holon_id" class="ml-2 px-2 py-1 bg-blue-100 text-blue-800 text-xs font-semibold rounded-full">Home Space</span>
            </td>
            <td class="p-4">{{ space.description }}</td>
            <td class="p-4">{{ space.created_at | date:'short' }}</td>
            <td class="p-4">{{ space.enabled }}</td>
            <td class="p-4 flex items-center">
              <button title="Modify Space" class="p-1 text-gray-500 hover:text-blue-600">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                  <path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z" />
                  <path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" />
                </svg>
              </button>
              <button title="Archive Space" class="p-1 text-gray-500 hover:text-red-600">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                  <path d="M4 3a2 2 0 100 4h12a2 2 0 100-4H4z" />
                  <path fill-rule="evenodd" d="M3 8h14v7a2 2 0 01-2 2H5a2 2 0 01-2-2V8zm5 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" clip-rule="evenodd" />
                </svg>
              </button>
              <button title="Derive New Space From" (click)="deriveNewSpace(space.id, 'content')" class="p-1 text-gray-500 hover:text-green-600">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z" clip-rule="evenodd" />
                </svg>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Meta Spaces Table -->
  <div>
    <h2 class="text-2xl font-semibold mb-4 text-orange-800">Meta Spaces</h2>
    <div class="overflow-x-auto bg-white rounded-lg shadow-md">
      <table class="min-w-full">
        <thead class="bg-orange-200">
          <tr>
            <th class="p-4 text-left">Name</th>
            <th class="p-4 text-left">Description</th>
            <th class="p-4 text-left">Created At</th>
            <th class="p-4 text-left">Enabled</th>
            <th class="p-4 text-left">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let space of metaSpaces()" class="border-b">
            <td class="p-4">
              <a [routerLink]="['/spaces', 'meta', space.id]" class="text-orange-600 hover:underline">{{ space.name }}</a>
              <span *ngIf="space.id === space.origin_holon_id" class="ml-2 px-2 py-1 bg-orange-100 text-orange-800 text-xs font-semibold rounded-full">Home Space</span>
            </td>
            <td class="p-4">{{ space.description }}</td>
            <td class="p-4">{{ space.created_at | date:'short' }}</td>
            <td class="p-4">{{ space.enabled }}</td>
            <td class="p-4 flex items-center">
              <button title="Modify Space" class="p-1 text-gray-500 hover:text-blue-600">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                  <path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z" />
                  <path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" />
                </svg>
              </button>
              <button title="Archive Space" class="p-1 text-gray-500 hover:text-red-600">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                  <path d="M4 3a2 2 0 100 4h12a2 2 0 100-4H4z" />
                  <path fill-rule="evenodd" d="M3 8h14v7a2 2 0 01-2 2H5a2 2 0 01-2-2V8zm5 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" clip-rule="evenodd" />
                </svg>
              </button>
              <button title="Derive New Space From" (click)="deriveNewSpace(space.id, 'meta')" class="p-1 text-gray-500 hover:text-green-600">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z" clip-rule="evenodd" />
                </svg>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

<!-- Create New Space Form -->
<div *ngIf="showCreateSpaceForm" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center">
  <div
    class="bg-white rounded-lg shadow-xl p-8 w-1/2"
    [ngClass]="{
      'border-blue-800': derivationOrigin() === 'content',
      'border-orange-800': derivationOrigin() === 'meta'
    }"
    style="min-width: 500px; border-width: 4px;"
  >
    <h2
      class="text-2xl font-semibold mb-6 pb-4 border-b"
      [ngClass]="{
        'text-blue-800': derivationOrigin() === 'content',
        'text-orange-800': derivationOrigin() === 'meta',
        'border-blue-200': derivationOrigin() === 'content',
        'border-orange-200': derivationOrigin() === 'meta'
      }"
    >
      Create New Space
    </h2>
    <form (ngSubmit)="createSpace()" #spaceForm="ngForm" class="space-y-6">
    
    <!-- Space Name & Type -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      <div class="md:col-span-2">
        <label for="spaceName" class="block text-sm font-medium text-gray-300">Space Name</label>
        <input
          type="text"
          id="spaceName"
          placeholder="e.g., My Project Holons"
          [(ngModel)]="newSpace.name"
          name="name"
          required
          class="mt-1 block w-full p-2 bg-gray-700 border border-gray-600 text-white rounded-lg shadow-md focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm placeholder-gray-400">
      </div>
      <div>
        <label for="spaceType" class="block text-sm font-medium text-gray-300">Space Type</label>
        <select
          id="spaceType"
          [(ngModel)]="newSpace.space_type"
          name="type"
          required
          class="mt-1 block w-full p-2 bg-gray-700 border border-gray-600 text-white rounded-lg shadow-md focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
          <option [ngValue]="null" disabled>Select a type...</option>
          <option value="Content">Content Space</option>
          <option value="Meta">Meta Space</option>
        </select>
      </div>
    </div>

    <!-- Description -->
    <div>
      <label for="spaceDescription" class="block text-sm font-medium text-gray-300">Description</label>
      <textarea
        id="spaceDescription"
        rows="3"
        placeholder="A brief description of what this space is for."
        [(ngModel)]="newSpace.description"
        name="description"
        required
        class="mt-1 block w-full p-2 bg-gray-700 border border-gray-600 text-white rounded-lg shadow-md focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm placeholder-gray-400"></textarea>
    </div>

    <!-- Origin Space ID -->
    <div>
      <label for="origin_holon_id" class="block text-sm font-medium text-gray-300">Origin Space ID</label>
      <input
        type="text"
        id="origin_holon_id"
        placeholder="Leave blank to create a new home space"
        [(ngModel)]="newSpace.origin_holon_id"
        name="origin_holon_id"
        class="mt-1 block w-full p-2 bg-gray-700 border border-gray-600 text-white rounded-lg shadow-md focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm placeholder-gray-400">
    </div>

    <!-- Metatype Reference & Metadata -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <label for="metatype_reference" class="block text-sm font-medium text-gray-300">Metatype Reference</label>
        <select
          id="metatype_reference"
          name="metatype_reference"
          class="mt-1 block w-full p-2 bg-gray-700 border border-gray-600 text-white rounded-lg shadow-md focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
          <option [ngValue]="null" disabled>Select a metatype...</option>

        </select>
      </div>
      <div>
        <label for="metadata" class="block text-sm font-medium text-gray-300">Metadata (JSON)</label>
        <textarea
          id="metadata"
          rows="3"
          placeholder='{ "theme": "dark" }'
          [(ngModel)]="metadataJson"
          name="metadata"
          class="mt-1 block w-full p-2 bg-gray-700 border border-gray-600 text-white rounded-lg shadow-md focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm placeholder-gray-400"></textarea>
      </div>
    </div>

    <!-- Form Actions -->
    <div class="flex justify-end pt-4">
      <button
        type="button"
        (click)="cancelCreateSpace()"
        class="mr-4 inline-flex justify-center py-2 px-4 border border-gray-600 shadow-sm text-sm font-medium rounded-md text-white bg-gray-700 hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200">
        Cancel
      </button>
      <button
        type="submit"
        [disabled]="!spaceForm.form.valid"
        class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors duration-200">
        Create Space
      </button>
    </div>
  </form>
  </div>
</div>